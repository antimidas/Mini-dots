import{a as m}from"../chunks/chunk-J5F3A7TB.js";import{t as g}from"../chunks/chunk-CHZKSFGE.js";import{c as S}from"../chunks/chunk-HPNQXUCM.js";import"../chunks/chunk-53OM6ECF.js";import"../chunks/chunk-PDIOZR2P.js";import"../chunks/chunk-BETA3R27.js";import{e as v}from"../chunks/chunk-3GYLW4KZ.js";var y=v(S());(async function(){let u=0,f=new Set([""]),r={textLinks:{class:"H23r4e",query:'A.H23r4e[jscontroller="Sk3xkc"]',foundLinks:[]},responseButtonLinks:{class:"SmjhRb amIOac",query:'A.SmjhRb.amIOac[jsname="MfaLsf"]',foundLinks:[]},responseButtonLinksVariant2:{class:"PTs6Oe",query:'A.PTs6Oe[jsname="sQeGi"]',foundLinks:[]},sourcePanelLinks:{class:"NDNGvf",query:"A.NDNGvf",foundLinks:[]},webResultButtonLinks:{class:"ZbQNgf",query:"A.ZbQNgf",foundLinks:[]}},a={searchPaneLinks:{class:"P9159d hMk97e BbI1ub",query:"A.P9159d.hMk97e.BbI1ub",foundLinks:[]}},c={searchLink:{prefix:"/search?",count:0},viewerLink:{prefix:"/viewer/",count:0}};function P(){for(let t in r)r[t].foundLinks=[];for(let t in a)a[t].foundLinks=[]}function p(t){return y.default.reduce(t,(e,{query:n})=>`${e}${e.length>0?", ":""}${n}`,"")}function k(t,e){let n=p(e),s=t.querySelectorAll(n);for(let i of s){let o=i.getAttribute("href"),l=i.getAttribute("class");if(o&&l){let L=Object.keys(e).find(b=>e[b].class===l);L&&e[L].foundLinks.push(o)}}}function d(t){Object.keys(t).forEach(e=>{Object.keys(c).forEach(n=>{t[e].foundLinks.length>0&&(c[n].count+=t[e].foundLinks.filter(s=>s.startsWith(c[n].prefix)).length)})})}function w(){d(r),d(a)}async function h(t,e){let n=!1;for(let s of Object.keys(e)){let i=e[s].foundLinks;if(i.length>0){let o=await m(i);t[s]={relevantLinks:o,rejectedLinksCount:i.length-o.length},n=o.length>0||n}else t[s]={relevantLinks:[],rejectedLinksCount:0}}return n}async function M(t,e){P(),t&&k(t,r),e&&k(e,a);let n={googleAIMode:!0,newSearchContainer:!1,newSearchPaneOpen:!1},s=!1;w(),Object.keys(c).forEach(i=>{let o=c[i];n[i]=o.count}),t&&(n.newSearchContainer=!0,s=await h(n,r)),e&&(n.newSearchPaneOpen=!0,s=await h(n,a)||s),s&&g("track","deweyResult",{pageType:"searchPage",url:window.location.href,pageDataMeta:JSON.stringify(n)},{anonymized:!0,skipAllowlistCheck:!0})}async function A(){let t=Array.from(window.document.querySelectorAll("A[selected], DIV[selected]"));if(t.length>0&&t.find(e=>e.innerText==="AI Mode")){let e=window.document.querySelectorAll('DIV.CKgc1d[jsname="CS7uPe"][jscontroller="uUCgYd"][data-complete="true"]'),n=window.document.querySelectorAll("DIV.PG8i1e.Ooz8t.PyLEff"),s=n.length>0?n[n.length-1].getAttribute("id")??"":"",i=e.length>u,o=!f.has(s);if(i||o){u=e.length;let l;o&&(f.add(s),l=n[n.length-1]),setTimeout(async()=>{M(i?e[e.length-1]:void 0,l)},2e3)}}}setInterval(()=>{A()},1e3)})();
