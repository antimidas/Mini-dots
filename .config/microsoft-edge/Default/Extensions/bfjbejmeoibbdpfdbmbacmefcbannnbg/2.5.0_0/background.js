var Oa=Object.defineProperty;var Da=(ce,M,ue)=>M in ce?Oa(ce,M,{enumerable:!0,configurable:!0,writable:!0,value:ue}):ce[M]=ue;var n=(ce,M,ue)=>Da(ce,typeof M!="symbol"?M+"":M,ue);var background=(function(){"use strict";var tt,st;function ce(r){return r==null||typeof r=="function"?{main:r}:r}var M;function ue(r){return{lang:M==null?void 0:M.lang,message:r==null?void 0:r.message,abortEarly:M==null?void 0:M.abortEarly,abortPipeEarly:M==null?void 0:M.abortPipeEarly}}var Fe;function nt(r){return Fe==null?void 0:Fe.get(r)}var Pe;function at(r){return Pe==null?void 0:Pe.get(r)}var Ie;function it(r,t){var e;return(e=Ie==null?void 0:Ie.get(r))==null?void 0:e.get(t)}function rr(r){var e,s;const t=typeof r;return t==="string"?`"${r}"`:t==="number"||t==="bigint"||t==="boolean"?`${r}`:t==="object"||t==="function"?(r&&((s=(e=Object.getPrototypeOf(r))==null?void 0:e.constructor)==null?void 0:s.name))??"null":t}function se(r,t,e,s,a){const c=a&&"input"in a?a.input:e.value,h=(a==null?void 0:a.expected)??r.expects??null,g=(a==null?void 0:a.received)??rr(c),i={kind:r.kind,type:r.type,input:c,expected:h,received:g,message:`Invalid ${t}: ${h?`Expected ${h} but r`:"R"}eceived ${g}`,requirement:r.requirement,path:a==null?void 0:a.path,issues:a==null?void 0:a.issues,lang:s.lang,abortEarly:s.abortEarly,abortPipeEarly:s.abortPipeEarly},w=r.kind==="schema",x=(a==null?void 0:a.message)??r.message??it(r.reference,i.lang)??(w?at(i.lang):null)??s.message??nt(i.lang);x!==void 0&&(i.message=typeof x=="function"?x(i):x),w&&(e.typed=!1),e.issues?e.issues.push(i):e.issues=[i]}function ae(r){return{version:1,vendor:"valibot",validate(t){return r["~run"]({value:t},ue())}}}function ot(r,t){const e=[...new Set(r)];return e.length>1?`(${e.join(` ${t} `)})`:e[0]??"never"}var ct=class extends Error{constructor(r){super(r[0].message),this.name="ValiError",this.issues=r}};function ut(r,t,e){return typeof r.fallback=="function"?r.fallback(t,e):r.fallback}function tr(r,t,e){return typeof r.default=="function"?r.default(t,e):r.default}function _e(r,t){return{kind:"schema",type:"array",reference:_e,expects:"Array",async:!1,item:r,message:t,get"~standard"(){return ae(this)},"~run"(e,s){var c;const a=e.value;if(Array.isArray(a)){e.typed=!0,e.value=[];for(let h=0;h<a.length;h++){const g=a[h],i=this.item["~run"]({value:g},s);if(i.issues){const w={type:"array",origin:"value",input:a,key:h,value:g};for(const x of i.issues)x.path?x.path.unshift(w):x.path=[w],(c=e.issues)==null||c.push(x);if(e.issues||(e.issues=i.issues),s.abortEarly){e.typed=!1;break}}i.typed||(e.typed=!1),e.value.push(i.value)}}else se(this,"type",e,s);return e}}}function pe(r){return{kind:"schema",type:"boolean",reference:pe,expects:"boolean",async:!1,message:r,get"~standard"(){return ae(this)},"~run"(t,e){return typeof t.value=="boolean"?t.typed=!0:se(this,"type",t,e),t}}}function N(r,t){return{kind:"schema",type:"literal",reference:N,expects:rr(r),async:!1,literal:r,message:t,get"~standard"(){return ae(this)},"~run"(e,s){return e.value===this.literal?e.typed=!0:se(this,"type",e,s),e}}}function sr(r){return{kind:"schema",type:"number",reference:sr,expects:"number",async:!1,message:r,get"~standard"(){return ae(this)},"~run"(t,e){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:se(this,"type",t,e),t}}}function z(r,t){return{kind:"schema",type:"object",reference:z,expects:"Object",async:!1,entries:r,message:t,get"~standard"(){return ae(this)},"~run"(e,s){var c;const a=e.value;if(a&&typeof a=="object"){e.typed=!0,e.value={};for(const h in this.entries){const g=this.entries[h];if(h in a||(g.type==="exact_optional"||g.type==="optional"||g.type==="nullish")&&g.default!==void 0){const i=h in a?a[h]:tr(g),w=g["~run"]({value:i},s);if(w.issues){const x={type:"object",origin:"value",input:a,key:h,value:i};for(const L of w.issues)L.path?L.path.unshift(x):L.path=[x],(c=e.issues)==null||c.push(L);if(e.issues||(e.issues=w.issues),s.abortEarly){e.typed=!1;break}}w.typed||(e.typed=!1),e.value[h]=w.value}else if(g.fallback!==void 0)e.value[h]=ut(g);else if(g.type!=="exact_optional"&&g.type!=="optional"&&g.type!=="nullish"&&(se(this,"key",e,s,{input:void 0,expected:`"${h}"`,path:[{type:"object",origin:"key",input:a,key:h,value:a[h]}]}),s.abortEarly))break}}else se(this,"type",e,s);return e}}}function J(r,t){return{kind:"schema",type:"optional",reference:J,expects:`(${r.expects} | undefined)`,async:!1,wrapped:r,default:t,get"~standard"(){return ae(this)},"~run"(e,s){return e.value===void 0&&(this.default!==void 0&&(e.value=tr(this,e,s)),e.value===void 0)?(e.typed=!0,e):this.wrapped["~run"](e,s)}}}function H(r){return{kind:"schema",type:"string",reference:H,expects:"string",async:!1,message:r,get"~standard"(){return ae(this)},"~run"(t,e){return typeof t.value=="string"?t.typed=!0:se(this,"type",t,e),t}}}function nr(r){let t;if(r)for(const e of r)t?t.push(...e.issues):t=e.issues;return t}function ve(r,t){return{kind:"schema",type:"union",reference:ve,expects:ot(r.map(e=>e.expects),"|"),async:!1,options:r,message:t,get"~standard"(){return ae(this)},"~run"(e,s){let a,c,h;for(const g of this.options){const i=g["~run"]({value:e.value},s);if(i.typed)if(i.issues)c?c.push(i):c=[i];else{a=i;break}else h?h.push(i):h=[i]}if(a)return a;if(c){if(c.length===1)return c[0];se(this,"type",e,s,{issues:nr(c)}),e.typed=!0}else{if((h==null?void 0:h.length)===1)return h[0];se(this,"type",e,s,{issues:nr(h)})}return e}}}function W(r,t,e){const s=r["~run"]({value:t},ue(e));if(s.issues)throw new ct(s.issues);return s.value}const ar="3.7.8",lt=ar,me=typeof Buffer=="function",ir=typeof TextDecoder=="function"?new TextDecoder:void 0,or=typeof TextEncoder=="function"?new TextEncoder:void 0,be=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Re=(r=>{let t={};return r.forEach((e,s)=>t[e]=s),t})(be),ht=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,q=String.fromCharCode.bind(String),cr=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):r=>new Uint8Array(Array.prototype.slice.call(r,0)),ur=r=>r.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),lr=r=>r.replace(/[^A-Za-z0-9\+\/]/g,""),hr=r=>{let t,e,s,a,c="";const h=r.length%3;for(let g=0;g<r.length;){if((e=r.charCodeAt(g++))>255||(s=r.charCodeAt(g++))>255||(a=r.charCodeAt(g++))>255)throw new TypeError("invalid character found");t=e<<16|s<<8|a,c+=be[t>>18&63]+be[t>>12&63]+be[t>>6&63]+be[t&63]}return h?c.slice(0,h-3)+"===".substring(h):c},Ce=typeof btoa=="function"?r=>btoa(r):me?r=>Buffer.from(r,"binary").toString("base64"):hr,je=me?r=>Buffer.from(r).toString("base64"):r=>{let e=[];for(let s=0,a=r.length;s<a;s+=4096)e.push(q.apply(null,r.subarray(s,s+4096)));return Ce(e.join(""))},Ue=(r,t=!1)=>t?ur(je(r)):je(r),pt=r=>{if(r.length<2){var t=r.charCodeAt(0);return t<128?r:t<2048?q(192|t>>>6)+q(128|t&63):q(224|t>>>12&15)+q(128|t>>>6&63)+q(128|t&63)}else{var t=65536+(r.charCodeAt(0)-55296)*1024+(r.charCodeAt(1)-56320);return q(240|t>>>18&7)+q(128|t>>>12&63)+q(128|t>>>6&63)+q(128|t&63)}},mt=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,pr=r=>r.replace(mt,pt),mr=me?r=>Buffer.from(r,"utf8").toString("base64"):or?r=>je(or.encode(r)):r=>Ce(pr(r)),fe=(r,t=!1)=>t?ur(mr(r)):mr(r),fr=r=>fe(r,!0),ft=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,dt=r=>{switch(r.length){case 4:var t=(7&r.charCodeAt(0))<<18|(63&r.charCodeAt(1))<<12|(63&r.charCodeAt(2))<<6|63&r.charCodeAt(3),e=t-65536;return q((e>>>10)+55296)+q((e&1023)+56320);case 3:return q((15&r.charCodeAt(0))<<12|(63&r.charCodeAt(1))<<6|63&r.charCodeAt(2));default:return q((31&r.charCodeAt(0))<<6|63&r.charCodeAt(1))}},dr=r=>r.replace(ft,dt),gr=r=>{if(r=r.replace(/\s+/g,""),!ht.test(r))throw new TypeError("malformed base64.");r+="==".slice(2-(r.length&3));let t,e,s,a=[];for(let c=0;c<r.length;)t=Re[r.charAt(c++)]<<18|Re[r.charAt(c++)]<<12|(e=Re[r.charAt(c++)])<<6|(s=Re[r.charAt(c++)]),e===64?a.push(q(t>>16&255)):s===64?a.push(q(t>>16&255,t>>8&255)):a.push(q(t>>16&255,t>>8&255,t&255));return a.join("")},Oe=typeof atob=="function"?r=>atob(lr(r)):me?r=>Buffer.from(r,"base64").toString("binary"):gr,br=me?r=>cr(Buffer.from(r,"base64")):r=>cr(Oe(r).split("").map(t=>t.charCodeAt(0))),yr=r=>br(xr(r)),gt=me?r=>Buffer.from(r,"base64").toString("utf8"):ir?r=>ir.decode(br(r)):r=>dr(Oe(r)),xr=r=>lr(r.replace(/[-_]/g,t=>t=="-"?"+":"/")),De=r=>gt(xr(r)),bt=r=>{if(typeof r!="string")return!1;const t=r.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},wr=r=>({value:r,enumerable:!1,writable:!0,configurable:!0}),Ar=function(){const r=(t,e)=>Object.defineProperty(String.prototype,t,wr(e));r("fromBase64",function(){return De(this)}),r("toBase64",function(t){return fe(this,t)}),r("toBase64URI",function(){return fe(this,!0)}),r("toBase64URL",function(){return fe(this,!0)}),r("toUint8Array",function(){return yr(this)})},vr=function(){const r=(t,e)=>Object.defineProperty(Uint8Array.prototype,t,wr(e));r("toBase64",function(t){return Ue(this,t)}),r("toBase64URI",function(){return Ue(this,!0)}),r("toBase64URL",function(){return Ue(this,!0)})},Rr={version:ar,VERSION:lt,atob:Oe,atobPolyfill:gr,btoa:Ce,btoaPolyfill:hr,fromBase64:De,toBase64:fe,encode:fe,encodeURI:fr,encodeURL:fr,utob:pr,btou:dr,decode:De,isValid:bt,fromUint8Array:Ue,toUint8Array:yr,extendString:Ar,extendUint8Array:vr,extendBuiltins:()=>{Ar(),vr()}};var yt=xt;function xt(r,t,e){return t==null||t>=r.length?r:(e==null&&(e="..."),r.slice(0,Math.max(0,t-e.length))+e)}function m(r,t,e={}){const a=new URLSearchParams(e).toString();return a===""?`${r}${t}`:`${r}${t}?${a}`}function wt(r){return Rr.encode(r).trim()}function ye(r){const t=/\d+$/.exec(r);return t&&t[0]?t[0]:""}function At(r){const t=r.split("-");return t.slice(1-t.length).join("-")}function Ur(r){return!("setAPIKey"in r)}function vt(r){return"setAPIKey"in r}function Rt(r,t=32){return yt(r,t)}const Ut=["ip","asn","btc","cve","eth","url"];function kt(r){return r.charAt(0).toUpperCase()+r.slice(1)}function Lt(r){return JSON.stringify(r)}function Bt(r){return Ut.includes(r)}function St(r){return Bt(r)?r.toUpperCase():r}function Tt(r){return`${kt(r.action)} ${Rt(r.query)} as ${St(r.type)} on ${r.name}`}const $t={withStackTrace:!1},kr=(r,t,e=$t)=>{const s=t.isOk()?{type:"Ok",value:t.value}:{type:"Err",value:t.error},a=e.withStackTrace?new Error().stack:void 0;return{data:s,message:r,stack:a}};function le(r,t,e,s){function a(c){return c instanceof e?c:new e(function(h){h(c)})}return new(e||(e=Promise))(function(c,h){function g(x){try{w(s.next(x))}catch(L){h(L)}}function i(x){try{w(s.throw(x))}catch(L){h(L)}}function w(x){x.done?c(x.value):a(x.value).then(g,i)}w((s=s.apply(r,[])).next())})}function Lr(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],s=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ee(r){return this instanceof ee?(this.v=r,this):new ee(r)}function Br(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e.apply(r,t||[]),a,c=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",h),a[Symbol.asyncIterator]=function(){return this},a;function h(R){return function(E){return Promise.resolve(E).then(R,L)}}function g(R,E){s[R]&&(a[R]=function(O){return new Promise(function(I,_){c.push([R,O,I,_])>1||i(R,O)})},E&&(a[R]=E(a[R])))}function i(R,E){try{w(s[R](E))}catch(O){$(c[0][3],O)}}function w(R){R.value instanceof ee?Promise.resolve(R.value.v).then(x,L):$(c[0][2],R)}function x(R){i("next",R)}function L(R){i("throw",R)}function $(R,E){R(E),c.shift(),c.length&&i(c[0][0],c[0][1])}}function Et(r){var t,e;return t={},s("next"),s("throw",function(a){throw a}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(a,c){t[a]=r[a]?function(h){return(e=!e)?{value:ee(r[a](h)),done:!1}:c?c(h):h}:c}}function Ft(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=r[Symbol.asyncIterator],e;return t?t.call(r):(r=typeof Lr=="function"?Lr(r):r[Symbol.iterator](),e={},s("next"),s("throw"),s("return"),e[Symbol.asyncIterator]=function(){return this},e);function s(c){e[c]=r[c]&&function(h){return new Promise(function(g,i){h=r[c](h),a(g,i,h.done,h.value)})}}function a(c,h,g,i){Promise.resolve(i).then(function(w){c({value:w,done:g})},h)}}typeof SuppressedError=="function"&&SuppressedError;class P{constructor(t){this._promise=t}static fromSafePromise(t){const e=t.then(s=>new Y(s));return new P(e)}static fromPromise(t,e){const s=t.then(a=>new Y(a)).catch(a=>new X(e(a)));return new P(s)}static fromThrowable(t,e){return(...s)=>new P(le(this,void 0,void 0,function*(){try{return new Y(yield t(...s))}catch(a){return new X(e?e(a):a)}}))}static combine(t){return Pt(t)}static combineWithAllErrors(t){return It(t)}map(t){return new P(this._promise.then(e=>le(this,void 0,void 0,function*(){return e.isErr()?new X(e.error):new Y(yield t(e.value))})))}andThrough(t){return new P(this._promise.then(e=>le(this,void 0,void 0,function*(){if(e.isErr())return new X(e.error);const s=yield t(e.value);return s.isErr()?new X(s.error):new Y(e.value)})))}andTee(t){return new P(this._promise.then(e=>le(this,void 0,void 0,function*(){if(e.isErr())return new X(e.error);try{yield t(e.value)}catch{}return new Y(e.value)})))}orTee(t){return new P(this._promise.then(e=>le(this,void 0,void 0,function*(){if(e.isOk())return new Y(e.value);try{yield t(e.error)}catch{}return new X(e.error)})))}mapErr(t){return new P(this._promise.then(e=>le(this,void 0,void 0,function*(){return e.isOk()?new Y(e.value):new X(yield t(e.error))})))}andThen(t){return new P(this._promise.then(e=>{if(e.isErr())return new X(e.error);const s=t(e.value);return s instanceof P?s._promise:s}))}orElse(t){return new P(this._promise.then(e=>le(this,void 0,void 0,function*(){return e.isErr()?t(e.error):new Y(e.value)})))}match(t,e){return this._promise.then(s=>s.match(t,e))}unwrapOr(t){return this._promise.then(e=>e.unwrapOr(t))}safeUnwrap(){return Br(this,arguments,function*(){return yield ee(yield ee(yield*Et(Ft(yield ee(this._promise.then(e=>e.safeUnwrap()))))))})}then(t,e){return this._promise.then(t,e)}[Symbol.asyncIterator](){return Br(this,arguments,function*(){const e=yield ee(this._promise);return e.isErr()&&(yield yield ee(G(e.error))),yield ee(e.value)})}}function Sr(r){return new P(Promise.resolve(new Y(r)))}function G(r){return new P(Promise.resolve(new X(r)))}P.fromPromise,P.fromSafePromise,P.fromThrowable;const Tr=r=>{let t=u([]);for(const e of r)if(e.isErr()){t=T(e.error);break}else t.map(s=>s.push(e.value));return t},Pt=r=>P.fromSafePromise(Promise.all(r)).andThen(Tr),$r=r=>{let t=u([]);for(const e of r)e.isErr()&&t.isErr()?t.error.push(e.error):e.isErr()&&t.isOk()?t=T([e.error]):e.isOk()&&t.isOk()&&t.value.push(e.value);return t},It=r=>P.fromSafePromise(Promise.all(r)).andThen($r);var Me;(function(r){function t(a,c){return(...h)=>{try{const g=a(...h);return u(g)}catch(g){return T(c?c(g):g)}}}r.fromThrowable=t;function e(a){return Tr(a)}r.combine=e;function s(a){return $r(a)}r.combineWithAllErrors=s})(Me||(Me={}));function u(r){return new Y(r)}function T(r){return new X(r)}class Y{constructor(t){this.value=t}isOk(){return!0}isErr(){return!this.isOk()}map(t){return u(t(this.value))}mapErr(t){return u(this.value)}andThen(t){return t(this.value)}andThrough(t){return t(this.value).map(e=>this.value)}andTee(t){try{t(this.value)}catch{}return u(this.value)}orTee(t){return u(this.value)}orElse(t){return u(this.value)}asyncAndThen(t){return t(this.value)}asyncAndThrough(t){return t(this.value).map(()=>this.value)}asyncMap(t){return P.fromSafePromise(t(this.value))}unwrapOr(t){return this.value}match(t,e){return t(this.value)}safeUnwrap(){const t=this.value;return(function*(){return t})()}_unsafeUnwrap(t){return this.value}_unsafeUnwrapErr(t){throw kr("Called `_unsafeUnwrapErr` on an Ok",this,t)}*[Symbol.iterator](){return this.value}}class X{constructor(t){this.error=t}isOk(){return!1}isErr(){return!this.isOk()}map(t){return T(this.error)}mapErr(t){return T(t(this.error))}andThrough(t){return T(this.error)}andTee(t){return T(this.error)}orTee(t){try{t(this.error)}catch{}return T(this.error)}andThen(t){return T(this.error)}orElse(t){return t(this.error)}asyncAndThen(t){return G(this.error)}asyncAndThrough(t){return G(this.error)}asyncMap(t){return G(this.error)}unwrapOr(t){return t}match(t,e){return e(this.error)}safeUnwrap(){const t=this.error;return(function*(){throw yield T(t),new Error("Do not use this generator out of `safeTry`")})()}_unsafeUnwrap(t){throw kr("Called `_unsafeUnwrap` on an Err",this,t)}_unsafeUnwrapErr(t){return this.error}*[Symbol.iterator](){const t=this;return yield t,t}}Me.fromThrowable;const de=2147483647,re=36,Ne=1,xe=26,_t=38,Ct=700,Er=72,Fr=128,Pr="-",jt=/^xn--/,Ot=/[^\0-\x7F]/,Dt=/[\x2E\u3002\uFF0E\uFF61]/g,Mt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},qe=re-Ne,te=Math.floor,ze=String.fromCharCode;function ie(r){throw new RangeError(Mt[r])}function Nt(r,t){const e=[];let s=r.length;for(;s--;)e[s]=t(r[s]);return e}function Ir(r,t){const e=r.split("@");let s="";e.length>1&&(s=e[0]+"@",r=e[1]),r=r.replace(Dt,".");const a=r.split("."),c=Nt(a,t).join(".");return s+c}function _r(r){const t=[];let e=0;const s=r.length;for(;e<s;){const a=r.charCodeAt(e++);if(a>=55296&&a<=56319&&e<s){const c=r.charCodeAt(e++);(c&64512)==56320?t.push(((a&1023)<<10)+(c&1023)+65536):(t.push(a),e--)}else t.push(a)}return t}const qt=r=>String.fromCodePoint(...r),zt=function(r){return r>=48&&r<58?26+(r-48):r>=65&&r<91?r-65:r>=97&&r<123?r-97:re},Cr=function(r,t){return r+22+75*(r<26)-((t!=0)<<5)},jr=function(r,t,e){let s=0;for(r=e?te(r/Ct):r>>1,r+=te(r/t);r>qe*xe>>1;s+=re)r=te(r/qe);return te(s+(qe+1)*r/(r+_t))},Or=function(r){const t=[],e=r.length;let s=0,a=Fr,c=Er,h=r.lastIndexOf(Pr);h<0&&(h=0);for(let g=0;g<h;++g)r.charCodeAt(g)>=128&&ie("not-basic"),t.push(r.charCodeAt(g));for(let g=h>0?h+1:0;g<e;){const i=s;for(let x=1,L=re;;L+=re){g>=e&&ie("invalid-input");const $=zt(r.charCodeAt(g++));$>=re&&ie("invalid-input"),$>te((de-s)/x)&&ie("overflow"),s+=$*x;const R=L<=c?Ne:L>=c+xe?xe:L-c;if($<R)break;const E=re-R;x>te(de/E)&&ie("overflow"),x*=E}const w=t.length+1;c=jr(s-i,w,i==0),te(s/w)>de-a&&ie("overflow"),a+=te(s/w),s%=w,t.splice(s++,0,a)}return String.fromCodePoint(...t)},Dr=function(r){const t=[];r=_r(r);const e=r.length;let s=Fr,a=0,c=Er;for(const i of r)i<128&&t.push(ze(i));const h=t.length;let g=h;for(h&&t.push(Pr);g<e;){let i=de;for(const x of r)x>=s&&x<i&&(i=x);const w=g+1;i-s>te((de-a)/w)&&ie("overflow"),a+=(i-s)*w,s=i;for(const x of r)if(x<s&&++a>de&&ie("overflow"),x===s){let L=a;for(let $=re;;$+=re){const R=$<=c?Ne:$>=c+xe?xe:$-c;if(L<R)break;const E=L-R,O=re-R;t.push(ze(Cr(R+E%O,0))),L=te(E/O)}t.push(ze(Cr(L,0))),c=jr(a,w,g===h),a=0,++g}++a,++s}return t.join("")},Ht={version:"2.3.1",ucs2:{decode:_r,encode:qt},decode:Or,encode:Dr,toASCII:function(r){return Ir(r,function(t){return Ot.test(t)?"xn--"+Dr(t):t})},toUnicode:function(r){return Ir(r,function(t){return jt.test(t)?Or(t.slice(4).toLowerCase()):t})}};function Vt(r){return new RegExp(r.map(t=>t.source).join("|"),"gi")}function Kt(r){return["\\."," . ","[.","(.","{.","[dot","(dot","{dot"].some(t=>r.includes(t))}function Wt(r){return["[:","(:","{:"].some(t=>r.includes(t))}function Gt(r){return["[/","(/","{/"].some(t=>r.includes(t))}function Jt(r){return["[://","(://","{://"].some(t=>r.includes(t))}function Zt(r){return["[@","(@","{@","[at","(at","{at"].some(t=>r.includes(t))}function Yt(r){return["hxxp","h**p"].some(t=>r.includes(t))}function Xt(r){return Kt(r)&&(r=r.replace(Vt([/\s\.\s/,/([[({])\.([\])}])/,/([[({])\./,/\.([\])}])/,/\\\./,/([[({])dot([\])}])/]),".")),Wt(r)&&(r=r.replace(/[[({]:[\])}]/g,":")),Gt(r)&&(r=r.replace(/[[({]\/[\])}]/g,"/")),Jt(r)&&(r=r.replace(/[[({]:\/\/[\])}]/g,"://")),Zt(r)&&(r=r.replace(/[[({](?:at|@)[\])}]/gi,"@")),Yt(r)&&(r=r.replace(/h(?:xx|\*\*)p(s?):\/\//gi,"http$1://")),r}function Qt(r){return Ht.toASCII(r)}var es=["aaa","aarp","abarth","abb","abbott","abbvie","abc","able","abogado","abudhabi","ac","academy","accenture","accountant","accountants","aco","active","actor","ad","adac","ads","adult","ae","aeg","aero","aetna","af","afamilycompany","afl","africa","ag","agakhan","agency","ai","aig","aigo","airbus","airforce","airtel","akdn","al","alfaromeo","alibaba","alipay","allfinanz","allstate","ally","alsace","alstom","am","amazon","americanexpress","americanfamily","amex","amfam","amica","amsterdam","analytics","android","anquan","anz","ao","aol","apartments","app","apple","aq","aquarelle","ar","arab","aramco","archi","army","arpa","art","arte","as","asda","asia","associates","at","athleta","attorney","au","auction","audi","audible","audio","auspost","author","auto","autos","avianca","aw","aws","ax","axa","az","azure","ba","baby","baidu","banamex","bananarepublic","band","bank","bar","barcelona","barclaycard","barclays","barefoot","bargains","baseball","basketball","bauhaus","bayern","bb","bbc","bbt","bbva","bcg","bcn","bd","be","beats","beauty","beer","bentley","berlin","best","bestbuy","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","blanco","blockbuster","blog","bloomberg","blue","bm","bms","bmw","bn","bnl","bnpparibas","bo","boats","boehringer","bofa","bom","bond","boo","book","booking","boots","bosch","bostik","boston","bot","boutique","box","br","bradesco","bridgestone","broadway","broker","brother","brussels","bs","bt","budapest","bugatti","build","builders","business","buy","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","call","calvinklein","cam","camera","camp","cancerresearch","canon","capetown","capital","capitalone","car","caravan","cards","care","career","careers","cars","cartier","casa","case","caseih","cash","casino","cat","catering","catholic","cba","cbn","cbre","cbs","cc","cd","ceb","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","charity","chase","chat","cheap","chintai","chloe","christmas","chrome","chrysler","church","ci","cipriani","circle","cisco","citadel","citi","citic","city","cityeats","ck","cl","claims","cleaning","click","clinic","clinique","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","comcast","commbank","community","company","compare","computer","comsec","condos","construction","consulting","contact","contractors","cooking","cookingchannel","cool","coop","corsica","country","coupon","coupons","courses","cpa","cr","credit","creditcard","creditunion","cricket","crown","crs","cruise","cruises","csc","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dabur","dad","dance","data","date","dating","datsun","day","dclk","dds","de","deal","dealer","deals","degree","delivery","dell","deloitte","delta","democrat","dental","dentist","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","discover","dish","diy","dj","dk","dm","dnp","do","docs","doctor","dodge","dog","doha","domains","doosan","dot","download","drive","dtv","dubai","duck","dunlop","duns","dupont","durban","dvag","dvr","dz","earth","eat","ec","eco","edeka","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epost","epson","equipment","er","ericsson","erni","es","esq","estate","esurance","et","etisalat","eu","eurovision","eus","events","everbank","exchange","expert","exposed","express","extraspace","fage","fail","fairwinds","faith","family","fan","fans","farm","farmers","fashion","fast","fedex","feedback","ferrari","ferrero","fi","fiat","fidelity","fido","film","final","finance","financial","fire","firestone","firmdale","fish","fishing","fit","fitness","fj","fk","flickr","flights","flir","florist","flowers","flsmidth","fly","fm","fo","foo","food","foodnetwork","football","ford","forex","forsale","forum","foundation","fox","fr","free","fresenius","frl","frogans","frontdoor","frontier","ftr","fujitsu","fujixerox","fun","fund","furniture","futbol","fyi","ga","gal","gallery","gallo","gallup","game","games","gap","garden","gay","gb","gbiz","gd","gdn","ge","gea","gent","genting","george","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glade","glass","gle","global","globo","gm","gmail","gmbh","gmo","gmx","gn","godaddy","gold","goldpoint","golf","goo","goodhands","goodyear","goog","google","gop","got","gov","gp","gq","gr","grainger","graphics","gratis","green","gripe","grocery","group","gs","gt","gu","guardian","gucci","guge","guide","guitars","guru","gw","gy","hair","hamburg","hangout","haus","hbo","hdfc","hdfcbank","health","healthcare","help","helsinki","here","hermes","hgtv","hiphop","hisamitsu","hitachi","hiv","hk","hkt","hm","hn","hockey","holdings","holiday","homedepot","homegoods","homes","homesense","honda","honeywell","horse","hospital","host","hosting","hot","hoteles","hotels","hotmail","house","how","hr","hsbc","ht","htc","hu","hughes","hyatt","hyundai","ibm","icbc","ice","icu","id","ie","ieee","ifm","iinet","ikano","il","im","imamat","imdb","immo","immobilien","in","inc","industries","infiniti","info","ing","ink","institute","insurance","insure","int","intel","international","intuit","investments","io","ipiranga","iq","ir","irish","is","iselect","ismaili","ist","istanbul","it","itau","itv","iveco","iwc","jaguar","java","jcb","jcp","je","jeep","jetzt","jewelry","jio","jlc","jll","jm","jmp","jnj","jo","jobs","joburg","jot","joy","jp","jpmorgan","jprs","juegos","juniper","kaufen","kddi","ke","kerryhotels","kerrylogistics","kerryproperties","kfh","kg","kh","ki","kia","kids","kim","kinder","kindle","kitchen","kiwi","km","kn","koeln","komatsu","kosher","kp","kpmg","kpn","kr","krd","kred","kuokgroup","kw","ky","kyoto","kz","la","lacaixa","ladbrokes","lamborghini","lamer","lancaster","lancia","lancome","land","landrover","lanxess","lasalle","lat","latino","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","lefrak","legal","lego","lexus","lgbt","li","liaison","lidl","life","lifeinsurance","lifestyle","lighting","like","lilly","limited","limo","lincoln","linde","link","lipsy","live","living","lixil","lk","llc","llp","loan","loans","locker","locus","loft","lol","london","lotte","lotto","love","lpl","lplfinancial","lr","ls","lt","ltd","ltda","lu","lundbeck","lupin","luxe","luxury","lv","ly","ma","macys","madrid","maif","maison","makeup","man","management","mango","map","market","marketing","markets","marriott","marshalls","maserati","mattel","mba","mc","mckinsey","md","me","med","media","meet","melbourne","meme","memorial","men","menu","meo","merckmsd","metlife","mg","mh","miami","microsoft","mil","mini","mint","mit","mitsubishi","mk","ml","mlb","mls","mm","mma","mn","mo","mobi","mobile","mobily","moda","moe","moi","mom","monash","money","monster","montblanc","mopar","mormon","mortgage","moscow","moto","motorcycles","mov","movie","movistar","mp","mq","mr","ms","msd","mt","mtn","mtpc","mtr","mu","museum","music","mutual","mutuelle","mv","mw","mx","my","mz","na","nab","nadex","nagoya","name","nationwide","natura","navy","nba","nc","ne","nec","net","netbank","netflix","network","neustar","new","newholland","news","next","nextdirect","nexus","nf","nfl","ng","ngo","nhk","ni","nico","nike","nikon","ninja","nissan","nissay","nl","no","nokia","northwesternmutual","norton","now","nowruz","nowtv","np","nr","nra","nrw","ntt","nu","nyc","nz","obi","observer","off","office","okinawa","olayan","olayangroup","oldnavy","ollo","om","omega","one","ong","onl","online","onyourside","ooo","open","oracle","orange","org","organic","orientexpress","origins","osaka","otsuka","ott","ovh","pa","page","pamperedchef","panasonic","panerai","paris","pars","partners","parts","party","passagens","pay","pccw","pe","pet","pf","pfizer","pg","ph","pharmacy","phd","philips","phone","photo","photography","photos","physio","piaget","pics","pictet","pictures","pid","pin","ping","pink","pioneer","pizza","pk","pl","place","play","playstation","plumbing","plus","pm","pn","pnc","pohl","poker","politie","porn","post","pr","pramerica","praxi","press","prime","pro","prod","productions","prof","progressive","promo","properties","property","protection","pru","prudential","ps","pt","pub","pw","pwc","py","qa","qpon","quebec","quest","qvc","racing","radio","raid","re","read","realestate","realtor","realty","recipes","red","redstone","redumbrella","rehab","reise","reisen","reit","reliance","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rexroth","rich","richardli","ricoh","rightathome","ril","rio","rip","rmit","ro","rocher","rocks","rodeo","rogers","room","rs","rsvp","ru","rugby","ruhr","run","rw","rwe","ryukyu","sa","saarland","safe","safety","sakura","sale","salon","samsclub","samsung","sandvik","sandvikcoromant","sanofi","sap","sapo","sarl","sas","save","saxo","sb","sbi","sbs","sc","sca","scb","schaeffler","schmidt","scholarships","school","schule","schwarz","science","scjohnson","scor","scot","sd","se","search","seat","secure","security","seek","select","sener","services","ses","seven","sew","sex","sexy","sfr","sg","sh","shangrila","sharp","shaw","shell","shia","shiksha","shoes","shop","shopping","shouji","show","showtime","shriram","si","silk","sina","singles","site","sj","sk","ski","skin","sky","skype","sl","sling","sm","smart","smile","sn","sncf","so","soccer","social","softbank","software","sohu","solar","solutions","song","sony","soy","spa","space","spiegel","sport","spot","spreadbetting","sr","srl","srt","ss","st","stada","staples","star","starhub","statebank","statefarm","statoil","stc","stcgroup","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiftcover","swiss","sx","sy","sydney","symantec","systems","sz","tab","taipei","talk","taobao","target","tatamotors","tatar","tattoo","tax","taxi","tc","tci","td","tdk","team","tech","technology","tel","telecity","telefonica","temasek","tennis","teva","tf","tg","th","thd","theater","theatre","tiaa","tickets","tienda","tiffany","tips","tires","tirol","tj","tjmaxx","tjx","tk","tkmaxx","tl","tm","tmall","tn","to","today","tokyo","tools","top","toray","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","travelchannel","travelers","travelersinsurance","trust","trv","tt","tube","tui","tunes","tushu","tv","tvs","tw","tz","ua","ubank","ubs","uconnect","ug","uk","unicom","university","uno","uol","ups","us","uy","uz","va","vacations","vana","vanguard","vc","ve","vegas","ventures","verisign","versicherung","vet","vg","vi","viajes","video","vig","viking","villas","vin","vip","virgin","visa","vision","vista","vistaprint","viva","vivo","vlaanderen","vn","vodka","volkswagen","volvo","vote","voting","voto","voyage","vu","vuelos","wales","walmart","walter","wang","wanggou","warman","watch","watches","weather","weatherchannel","webcam","weber","website","wed","wedding","weibo","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","winners","wme","wolterskluwer","woodside","work","works","world","wow","ws","wtc","wtf","xbox","xerox","xfinity","xihuan","xin","xn--1ck2e1b","xn--1qqw23a","xn--2scrj9c","xn--3bst00m","xn--3ds443g","xn--3e0b707e","xn--3hcrj9c","xn--3oq18vl8pn36a","xn--3pxu8k","xn--4dbrk0ce","xn--4gbrim","xn--5su34j936bgsg","xn--5tzm5g","xn--6frz82g","xn--6qq986b3xl","xn--8y0a063a","xn--9dbq2a","xn--9et52u","xn--9krt00a","xn--11b4c3d","xn--30rr7y","xn--42c2d9a","xn--45br5cyl","xn--45brj9c","xn--45q11c","xn--54b7fta0cc","xn--55qw42g","xn--55qx5d","xn--80adxhks","xn--80ao21a","xn--80aqecdr1a","xn--80asehdb","xn--80aswg","xn--90a3ac","xn--90ae","xn--90ais","xn--b4w605ferd","xn--bck1b9a5dre4c","xn--c1avg","xn--c2br7g","xn--cck2b3b","xn--cckwcxetd","xn--cg4bki","xn--clchc0ea0b2g2a9gcd","xn--czr694b","xn--czrs0t","xn--czru2d","xn--d1acj3b","xn--d1alf","xn--e1a4c","xn--eckvdtc9d","xn--efvy88h","xn--estv75g","xn--fct429k","xn--fhbei","xn--fiq64b","xn--fiq228c5hs","xn--fiqs8s","xn--fiqz9s","xn--fjq720a","xn--flw351e","xn--fpcrj9c3d","xn--fzc2c9e2c","xn--fzys8d69uvgm","xn--g2xx48c","xn--gckr3f0f","xn--gecrj9c","xn--gk3at1e","xn--h2breg3eve","xn--h2brj9c","xn--h2brj9c8c","xn--hxt814e","xn--i1b6b1a6a2e","xn--imr513n","xn--io0a7i","xn--j1aef","xn--j1amh","xn--j6w193g","xn--jlq61u9w7b","xn--jlq480n2rg","xn--jvr189m","xn--kcrx77d1x4a","xn--kprw13d","xn--kpry57d","xn--kpu716f","xn--kput3i","xn--l1acc","xn--lgbbat1ad8j","xn--mgb9awbf","xn--mgba3a3ejt","xn--mgba3a4f16a","xn--mgba7c0bbn0a","xn--mgbaakc7dvf","xn--mgbaam7a8h","xn--mgbab2bd","xn--mgbah1a3hjkrd","xn--mgbai9azgqp6j","xn--mgbayh7gpa","xn--mgbb9fbpob","xn--mgbbh1a","xn--mgbbh1a71e","xn--mgbc0a9azcg","xn--mgbca7dzdo","xn--mgbcpq6gpa1a","xn--mgberp4a5d4ar","xn--mgbgu82a","xn--mgbi4ecexp","xn--mgbpl2fh","xn--mgbt3dhd","xn--mgbtx2b","xn--mgbx4cd0ab","xn--mix891f","xn--mk1bu44c","xn--mxtq1m","xn--ngbc5azd","xn--ngbe9e0a","xn--ngbrx","xn--node","xn--nqv7f","xn--nqv7fs00ema","xn--nyqy26a","xn--o3cw4h","xn--ogbpf8fl","xn--otu796d","xn--p1acf","xn--p1ai","xn--pbt977c","xn--pgbs0dh","xn--pssy2u","xn--q7ce6a","xn--q9jyb4c","xn--qcka1pmc","xn--qxa6a","xn--qxam","xn--rhqv96g","xn--rovu88b","xn--rvc1e0am3e","xn--s9brj9c","xn--ses554g","xn--t60b56a","xn--tckwe","xn--tiq49xqyj","xn--unup4y","xn--vermgensberater-ctb","xn--vermgensberatung-pwb","xn--vhquv","xn--vuq861b","xn--w4r85el8fhu5dnra","xn--w4rs40l","xn--wgbh1c","xn--wgbl6a","xn--xhq521b","xn--xkc2al3hye2a","xn--xkc2dl3a5ee0h","xn--y9a3aq","xn--yfro4i67o","xn--ygbi2ammx","xn--zfr164b","xperia","xxx","xyz","yachts","yahoo","yamaxun","yandex","ye","yodobashi","yoga","yokohama","you","youtube","yt","yun","za","zappos","zara","zero","zip","zippo","zm","zone","zuerich","zw"],Mr="a-z",rs="0-9",we=`${Mr}${rs}`,ts=`[${we}]{1,63}`,ss=`[${we}]{0,63}`,ns=`[${we}-]{0,63}`,as=`[${Mr}-]{2,63}`,is="xn--",os=as,cs=`${es.sort((r,t)=>t.length-r.length).join("|")}`,us=/(AS|ASN)\d+/gi,ls=/\b[13][a-km-zA-HJ-NP-Z0-9]{26,33}\b/g,hs=/(CVE-(19|20)\d{2}-\d{4,7})/gi,ps=/\b0x[a-fA-F0-9]{40}\b/g,ms=/pub-\d{16}/gi,fs=/UA-\d{4,9}(-\d{1,2})?/gi,ds=/\b[A-F0-9]{32}\b/gi,gs=/\b[A-F0-9]{40}\b/gi,bs=/\b[A-F0-9]{64}\b/gi,ys=/\b4[0-9AB][1-9A-HJ-NP-Za-km-z]{93}\b/g;function He(r={strict:!0}){const t=r.strict?cs:os,e=`(?=[${we}.\\-]{1,252}\\.(${t})\\b)((${is}${ss}|${ts})((?!.{0,63}--)${ns}[${we}])?\\.)+(${t})\\b`;return new RegExp(e,"gi")}var Nr="[a-fA-F\\d:]",oe=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${Nr})|(?<=${Nr})(?=\\s|$))`:"",ne="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",j="[a-fA-F\\d]{1,4}",qr=`
(?:
(?:${j}:){7}(?:${j}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${j}:){6}(?:${ne}|:${j}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${j}:){5}(?::${ne}|(?::${j}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${j}:){4}(?:(?::${j}){0,1}:${ne}|(?::${j}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${j}:){3}(?:(?::${j}){0,2}:${ne}|(?::${j}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${j}:){2}(?:(?::${j}){0,3}:${ne}|(?::${j}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${j}:){1}(?:(?::${j}){0,4}:${ne}|(?::${j}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${j}){0,5}:${ne}|(?::${j}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),ke=r=>new RegExp(`(?:${oe(r)}${ne}${oe(r)})|(?:${oe(r)}${qr}${oe(r)})`,"g");ke.v4=r=>new RegExp(`${oe(r)}${ne}${oe(r)}`,"g"),ke.v6=r=>new RegExp(`${oe(r)}${qr}${oe(r)}`,"g");function xs(r={strict:!0}){const h=`(?:(?:(?:https?)://))(?:\\S+(?::\\S*)?@)?(?:${He(r).source}|localhost|${ke.v4().source})(?::\\d{2,5})?(?:[/?#][^\\s"]*)?`;return new RegExp(h,"gi")}function ws(r={strict:!0}){const s=`[a-zA-Z0-9.!#$%&'*+/=?^_\`{|}~-]+@${He(r).source}`;return new RegExp(s,"gi")}function K(r,t){if(t.global){const s=t.flags.replace("g","");t=new RegExp(t.source,s)}const e=r.match(t);return e===null?null:e[0]}function As(r){return K(r,ds)}function vs(r){return K(r,gs)}function Rs(r){return K(r,bs)}function Us(r){return r.includes("AS")?K(r,us):null}function ks(r,t={strict:!0}){if(!r.includes("."))return null;const e=He(t);return K(r,e)}function Ls(r,t={strict:!0}){if(!r.includes("@")&&!r.includes("."))return null;const e=ws(t);return K(r,e)}function Bs(r){return r.includes(".")?K(r,ke.v4()):null}function Ss(r,t={strict:!0}){const e=xs(t);return K(r,e)}function Ts(r){return K(r,hs)}function $s(r){return K(r,ls)}function Es(r){return K(r,ys)}function Fs(r){return K(r,ms)}function Ps(r){return K(r,fs)}function Is(r){return K(r,ps)}let Le=class{constructor(){n(this,"baseURL");n(this,"name");n(this,"supportedTypes",[]);n(this,"apiKey");n(this,"apiKeyRequired",!0);this.baseURL="http://example.com",this.name="Base"}setAPIKey(t){this.apiKey=t}scanByURL(t){return G("Not implemented")}scanByIP(t){return G("Not implemented")}scanByDomain(t){return G("Not implemented")}};class _s extends Le{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["url"]);n(this,"apiKey");n(this,"apiKeyRequired",!1);this.baseURL="https://www.browserling.com",this.name="Browserling"}scanByURL(e){return Sr(m(this.baseURL,`/browse/win/7/ie/11/${encodeURIComponent(e)}`))}}const Cs=z({sha256:H()}),js=z({message:H()});let Os=class extends Le{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["url"]);n(this,"apiKey");this.baseURL="https://www.hybrid-analysis.com",this.name="HybridAnalysis"}setAPIKey(e){this.apiKey=e}scanByURL(e){if(!this.apiKey)return G("Please set your HybridAnalysis API key via the option.");const s=new FormData;s.append("scan_type","all"),s.append("url",e);const a={"api-key":this.apiKey,"user-agent":"Falcon Sandbox"},c=async()=>{const h=await fetch(`${this.baseURL}/api/v2/quick-scan/url`,{method:"POST",headers:a,body:s}),g=await h.json();if(!h.ok){const x=W(js,g);throw Error(x.message)}return`https://www.hybrid-analysis.com/sample/${W(Cs,g).sha256}/`};return P.fromThrowable(c,h=>h.message)()}};const Ds=z({result:H()}),Ms=z({message:H(),status:sr()});let Ns=class extends Le{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","url"]);n(this,"apiKey");n(this,"visibility","public");this.baseURL="https://urlscan.io",this.name="urlscan.io"}setAPIKey(e){this.apiKey=e}setVisibility(e){this.visibility=e}scanByIP(e){return this.scan(e)}scanByDomain(e){return this.scan(e)}scanByURL(e){return this.scan(e)}scan(e){if(!this.apiKey)return G("Please set your urlscan.io API key via the option.");const s=async()=>{const a=await fetch(`${this.baseURL}/api/v1/scan/`,{method:"POST",headers:{"API-KEY":this.apiKey,"content-type":"application/json"},body:JSON.stringify({visibility:this.visibility,url:e})}),c=await a.json();if(!a.ok){const g=W(Ms,c);throw new Error(g.message)}return`${W(Ds,c).result}loading`};return P.fromThrowable(s,a=>a.message)()}};const qs=z({data:z({id:H(),type:H()})}),zs=z({error:z({message:H()})});let Hs=class extends Le{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["url"]);n(this,"apiKey");this.baseURL="https://www.virustotal.com",this.name="VirusTotal"}setAPIKey(e){this.apiKey=e}permaLink(e){const a=e.split("-")[1];return m(this.baseURL,`/gui/url/${a}/details`)}scanByURL(e){if(!this.apiKey)return G("Please set your VirusTotal API key via the option.");const s=new FormData;s.append("url",e);const a={"x-apikey":this.apiKey},c=async()=>{const h=await fetch(m(this.baseURL,"/api/v3/urls"),{method:"POST",headers:a,body:s}),g=await h.json();if(!h.ok){const w=W(zs,g);throw new Error(w.error.message)}const i=W(qs,g);return this.permaLink(i.data.id)};return P.fromThrowable(c,h=>h.message)()}};const Vs=[new _s,new Os,new Ns,new Hs],Ks=z({strict:J(pe(),!1),refang:J(pe(),!0),punycode:J(pe(),!1),debug:J(pe(),!1)}),Ws=z({href:J(pe(),!0),disabledSearcherNames:J(_e(H()),[]),disabledScannerNames:J(_e(H()),[]),urlscanVisibility:J(ve([N("public"),N("unlisted"),N("private")]),"public")}),Ve=z({...Ks.entries,...Ws.entries}),Ke=z({hybridAnalysisAPIKey:J(H()),urlscanAPIKey:J(H()),virusTotalAPIKey:J(H())}),zr=z({...Ve.entries,...Ke.entries}),Gs=z({action:ve([N("scan"),N("search")]),query:H(),type:ve([N("asn"),N("btc"),N("cve"),N("domain"),N("email"),N("eth"),N("gaPubID"),N("gaTrackID"),N("hash"),N("ip"),N("url")]),name:H()});class A{constructor(){n(this,"baseURL");n(this,"name");n(this,"supportedTypes",[]);this.baseURL="http://example.com",this.name="Base"}searchByASN(t){return T("Not Implemented")}searchByBTC(t){return T("Not Implemented")}searchByCVE(t){return T("Not Implemented")}searchByDomain(t){return T("Not Implemented")}searchByEmail(t){return T("Not Implemented")}searchByETH(t){return T("Not Implemented")}searchByGAPubID(t){return T("Not Implemented")}searchByGATrackID(t){return T("Not Implemented")}searchByHash(t){return T("Not Implemented")}searchByIP(t){return T("Not Implemented")}searchByURL(t){return T("Not Implemented")}searchByXMR(t){return T("Not Implemented")}}class Js extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip"]);this.baseURL="https://www.abuseipdb.com",this.name="AbuseIPDB"}searchByIP(e){return u(m(this.baseURL,`/check/${e}`))}}class Zs extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",[]);this.baseURL="https://example.com",this.name="all"}}class Ys extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash"]);this.baseURL="https://app.any.run",this.name="ANY.RUN"}searchByHash(e){return u(this.baseURL+`/submissions/#filehash:${e}`)}}class Xs extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["url"]);this.baseURL="https://web.archive.org",this.name="archive.org"}searchByURL(e){return u(m(this.baseURL,`/web/*/${e}`))}}class Qs extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["url"]);this.baseURL="http://archive.fo",this.name="archive.today"}searchByURL(e){return u(m(this.baseURL,`/${e}`))}}class en extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","asn"]);this.baseURL="https://bgpview.io",this.name="BGPView"}searchByIP(e){return u(m(this.baseURL,`/ip/${e}`))}searchByASN(e){const s=ye(e);return u(m(this.baseURL,`/asn/${s}`))}}class rn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["btc"]);this.baseURL="https://www.blockchain.com",this.name="Blockchain.com"}searchByBTC(e){return u(m(this.baseURL,`/btc/address/${e}`))}}class tn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["btc"]);this.baseURL="https://live.blockcypher.com",this.name="BlockCypher"}searchByBTC(e){return u(m(this.baseURL,`/btc/address/${e}/`))}}class sn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","asn","domain","email"]);this.baseURL="https://search.censys.io",this.name="Censys"}searchByIP(e){return u(m(this.baseURL,`/hosts/${e}`))}searchByASN(e){const s=ye(e);return u(m(this.baseURL,"/search",{q:`autonomous_system.asn:${s}`,resource:"hosts"}))}searchByDomain(e){return u(m(this.baseURL,"/search",{q:`parsed.names:${e}`,resource:"certificates"}))}searchByEmail(e){return u(m(this.baseURL,"/search",{q:`parsed.subject.email_address:${e}`,resource:"certificates"}))}}class nn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain"]);this.baseURL="https://checkphish.ai",this.name="CheckPhish"}searchByIP(e){return u(m(this.baseURL,`/ip/${e}`))}searchByDomain(e){return u(m(this.baseURL,`/domain/${e}`))}}class an extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["cve"]);this.baseURL="https://ess.coalitioninc.com",this.name="Coalition"}searchByCVE(e){return u(m(this.baseURL,"/cve/",{id:e}))}}class on extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["domain"]);this.baseURL="https://crt.sh",this.name="crt.sh"}searchByDomain(e){return u(m(this.baseURL,"/",{q:e}))}}class cn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["domain"]);this.baseURL="https://dns.coffee",this.name="DNS Coffee"}searchByDomain(e){return u(m(this.baseURL,`/domains/${e}`))}}class un extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain"]);this.baseURL="https://dnslytics.com",this.name="DNSlytics"}searchByIP(e){return u(m(this.baseURL,`/ip/${e}`))}searchByDomain(e){return u(m(this.baseURL,`/domain/${e}`))}}class ln extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain"]);this.baseURL="https://whois.domaintools.com",this.name="DomainTools"}searchByIP(e){return this.search(e)}searchByDomain(e){return this.search(e)}search(e){return u(m(this.baseURL,`/${e}`))}}class hn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["email"]);this.baseURL="https://emailrep.io",this.name="EmailRep"}searchByEmail(e){return u(m(this.baseURL,`/${e}`))}}class pn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["cve"]);this.baseURL="https://www.exploit-db.com",this.name="ExploitDatabase"}searchByCVE(e){const s=At(e);return u(m(this.baseURL,"/search",{cve:s}))}}class mn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash"]);this.baseURL="https://www.filescan.io",this.name="FileScan.IO"}searchByHash(e){return u(m(this.baseURL,"/search-result",{query:e}))}}class fn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","url","cve"]);this.baseURL="https://fortiguard.com",this.name="FortiGuard"}searchByIP(e){return u(m(this.baseURL,"/search",{q:e,engine:7}))}searchByURL(e){return u(m(this.baseURL,"/search",{q:e,engine:7}))}searchByCVE(e){return u(m(this.baseURL,"/search",{q:e,engine:3}))}}class dn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["domain","url"]);this.baseURL="https://transparencyreport.google.com",this.name="GoogleSafeBrowsing"}searchByDomain(e){return this.search(e)}searchByURL(e){return this.search(e)}search(e){return u(m(this.baseURL,"/safe-browsing/search",{url:e}))}}class gn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","asn","cve"]);this.baseURL="https://viz.greynoise.io",this.name="GreyNoise"}searchByIP(e){return this.search(`ip:${e}`)}searchByDomain(e){return this.search(`metadata.rdns:${e}`)}searchByASN(e){return this.search(`metadata.asn:${e}`)}searchByCVE(e){return this.search(`cve:${e}`)}search(e){return u(m(this.baseURL,"/query",{gnql:e}))}}class bn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["domain"]);this.baseURL="https://host.io",this.name="host.io"}searchByDomain(e){return u(m(this.baseURL,`/${e}`))}}class yn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","asn"]);this.baseURL="https://bgp.he.net",this.name="HurricaneElectric"}searchByIP(e){return u(m(this.baseURL,`/ip/${e}`))}searchByDomain(e){return u(m(this.baseURL,`/dns/${e}`))}searchByASN(e){const s=ye(e);return u(m(this.baseURL,`/AS${s}`))}}class xn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","hash"]);this.baseURL="https://www.hybrid-analysis.com",this.name="HybridAnalysis"}searchByHash(e){return u(m(this.baseURL,"/search",{query:`${e}`}))}searchByIP(e){return u(m(this.baseURL,"/search",{query:`host:${e}`}))}searchByDomain(e){return u(m(this.baseURL,"/search",{query:`domain:${e}`}))}}class wn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash"]);this.baseURL="https://labs.inquest.net",this.name="InQuest"}searchByHash(e){return e.length!==64?T("InQuest supports SHA256 hash only"):u(m(this.baseURL,`/dfi/sha256/${e}`))}}class An extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash"]);this.baseURL="https://analyze.intezer.com",this.name="Intezer"}searchByHash(e){return u(m(this.baseURL,`/#/files/${e}`))}}class vn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","asn"]);this.baseURL="https://ipinfo.io",this.name="IPinfo"}searchByIP(e){return u(m(this.baseURL,`/${e}`))}searchByASN(e){return u(m(this.baseURL,`/${e}`))}}class Rn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","asn"]);this.baseURL="https://en.ipip.net",this.name="IPIP"}searchByIP(e){return u(m(this.baseURL,`/ip/${e}.html`))}searchByASN(e){const s=ye(e);return u(m("https://whois.ipip.net",`/AS${s}`))}}class Un extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash"]);this.baseURL="https://www.joesandbox.com",this.name="JoeSandbox"}searchByHash(e){return u(m(this.baseURL,"/analysis/search",{q:e}))}}class kn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash"]);this.baseURL="https://www.malshare.com",this.name="MalShare"}searchByHash(e){return u(m(this.baseURL,"/sample.php",{action:"detail",hash:e}))}}var Ln=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bn(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Sn(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var t=r.default;if(typeof t=="function"){var e=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var a=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:function(){return r[s]}})}),e}var We={exports:{}};const Hr=Sn(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.11.1
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2025
 * @license MIT
 */var Vr;function Tn(){return Vr||(Vr=1,(function(r){(function(){var t="input is invalid type",e=typeof window=="object",s=e?window:{};s.JS_SHA256_NO_WINDOW&&(e=!1);var a=!e&&typeof self=="object",c=!s.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node&&process.type!="renderer";c?s=Ln:a&&(s=self);var h=!s.JS_SHA256_NO_COMMON_JS&&!0&&r.exports,g=!s.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",i="0123456789abcdef".split(""),w=[-2147483648,8388608,32768,128],x=[24,16,8,0],L=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],$=["hex","array","digest","arrayBuffer"],R=[];(s.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(l){return Object.prototype.toString.call(l)==="[object Array]"}),g&&(s.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(l){return typeof l=="object"&&l.buffer&&l.buffer.constructor===ArrayBuffer});var E=function(l,y){return function(f){return new C(y,!0).update(f)[l]()}},O=function(l){var y=E("hex",l);c&&(y=I(y,l)),y.create=function(){return new C(l)},y.update=function(b){return y.create().update(b)};for(var f=0;f<$.length;++f){var o=$[f];y[o]=E(o,l)}return y},I=function(l,y){var f=Hr,o=Hr.Buffer,b=y?"sha224":"sha256",p;o.from&&!s.JS_SHA256_NO_BUFFER_FROM?p=o.from:p=function(d){return new o(d)};var U=function(d){if(typeof d=="string")return f.createHash(b).update(d,"utf8").digest("hex");if(d==null)throw new Error(t);return d.constructor===ArrayBuffer&&(d=new Uint8Array(d)),Array.isArray(d)||ArrayBuffer.isView(d)||d.constructor===o?f.createHash(b).update(p(d)).digest("hex"):l(d)};return U},_=function(l,y){return function(f,o){return new ge(f,y,!0).update(o)[l]()}},he=function(l){var y=_("hex",l);y.create=function(b){return new ge(b,l)},y.update=function(b,p){return y.create(b).update(p)};for(var f=0;f<$.length;++f){var o=$[f];y[o]=_(o,l)}return y};function C(l,y){y?(R[0]=R[16]=R[1]=R[2]=R[3]=R[4]=R[5]=R[6]=R[7]=R[8]=R[9]=R[10]=R[11]=R[12]=R[13]=R[14]=R[15]=0,this.blocks=R):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=l}C.prototype.update=function(l){if(!this.finalized){var y,f=typeof l;if(f!=="string"){if(f==="object"){if(l===null)throw new Error(t);if(g&&l.constructor===ArrayBuffer)l=new Uint8Array(l);else if(!Array.isArray(l)&&(!g||!ArrayBuffer.isView(l)))throw new Error(t)}else throw new Error(t);y=!0}for(var o,b=0,p,U=l.length,d=this.blocks;b<U;){if(this.hashed&&(this.hashed=!1,d[0]=this.block,this.block=d[16]=d[1]=d[2]=d[3]=d[4]=d[5]=d[6]=d[7]=d[8]=d[9]=d[10]=d[11]=d[12]=d[13]=d[14]=d[15]=0),y)for(p=this.start;b<U&&p<64;++b)d[p>>>2]|=l[b]<<x[p++&3];else for(p=this.start;b<U&&p<64;++b)o=l.charCodeAt(b),o<128?d[p>>>2]|=o<<x[p++&3]:o<2048?(d[p>>>2]|=(192|o>>>6)<<x[p++&3],d[p>>>2]|=(128|o&63)<<x[p++&3]):o<55296||o>=57344?(d[p>>>2]|=(224|o>>>12)<<x[p++&3],d[p>>>2]|=(128|o>>>6&63)<<x[p++&3],d[p>>>2]|=(128|o&63)<<x[p++&3]):(o=65536+((o&1023)<<10|l.charCodeAt(++b)&1023),d[p>>>2]|=(240|o>>>18)<<x[p++&3],d[p>>>2]|=(128|o>>>12&63)<<x[p++&3],d[p>>>2]|=(128|o>>>6&63)<<x[p++&3],d[p>>>2]|=(128|o&63)<<x[p++&3]);this.lastByteIndex=p,this.bytes+=p-this.start,p>=64?(this.block=d[16],this.start=p-64,this.hash(),this.hashed=!0):this.start=p}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},C.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var l=this.blocks,y=this.lastByteIndex;l[16]=this.block,l[y>>>2]|=w[y&3],this.block=l[16],y>=56&&(this.hashed||this.hash(),l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),l[14]=this.hBytes<<3|this.bytes>>>29,l[15]=this.bytes<<3,this.hash()}},C.prototype.hash=function(){var l=this.h0,y=this.h1,f=this.h2,o=this.h3,b=this.h4,p=this.h5,U=this.h6,d=this.h7,k=this.blocks,v,F,S,V,B,D,Z,Ae,Qe,er,Ee;for(v=16;v<64;++v)B=k[v-15],F=(B>>>7|B<<25)^(B>>>18|B<<14)^B>>>3,B=k[v-2],S=(B>>>17|B<<15)^(B>>>19|B<<13)^B>>>10,k[v]=k[v-16]+F+k[v-7]+S<<0;for(Ee=y&f,v=0;v<64;v+=4)this.first?(this.is224?(Ae=300032,B=k[0]-1413257819,d=B-150054599<<0,o=B+24177077<<0):(Ae=704751109,B=k[0]-210244248,d=B-1521486534<<0,o=B+143694565<<0),this.first=!1):(F=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),S=(b>>>6|b<<26)^(b>>>11|b<<21)^(b>>>25|b<<7),Ae=l&y,V=Ae^l&f^Ee,Z=b&p^~b&U,B=d+S+Z+L[v]+k[v],D=F+V,d=o+B<<0,o=B+D<<0),F=(o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10),S=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),Qe=o&l,V=Qe^o&y^Ae,Z=d&b^~d&p,B=U+S+Z+L[v+1]+k[v+1],D=F+V,U=f+B<<0,f=B+D<<0,F=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),S=(U>>>6|U<<26)^(U>>>11|U<<21)^(U>>>25|U<<7),er=f&o,V=er^f&l^Qe,Z=U&d^~U&b,B=p+S+Z+L[v+2]+k[v+2],D=F+V,p=y+B<<0,y=B+D<<0,F=(y>>>2|y<<30)^(y>>>13|y<<19)^(y>>>22|y<<10),S=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),Ee=y&f,V=Ee^y&o^er,Z=p&U^~p&d,B=b+S+Z+L[v+3]+k[v+3],D=F+V,b=l+B<<0,l=B+D<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+l<<0,this.h1=this.h1+y<<0,this.h2=this.h2+f<<0,this.h3=this.h3+o<<0,this.h4=this.h4+b<<0,this.h5=this.h5+p<<0,this.h6=this.h6+U<<0,this.h7=this.h7+d<<0},C.prototype.hex=function(){this.finalize();var l=this.h0,y=this.h1,f=this.h2,o=this.h3,b=this.h4,p=this.h5,U=this.h6,d=this.h7,k=i[l>>>28&15]+i[l>>>24&15]+i[l>>>20&15]+i[l>>>16&15]+i[l>>>12&15]+i[l>>>8&15]+i[l>>>4&15]+i[l&15]+i[y>>>28&15]+i[y>>>24&15]+i[y>>>20&15]+i[y>>>16&15]+i[y>>>12&15]+i[y>>>8&15]+i[y>>>4&15]+i[y&15]+i[f>>>28&15]+i[f>>>24&15]+i[f>>>20&15]+i[f>>>16&15]+i[f>>>12&15]+i[f>>>8&15]+i[f>>>4&15]+i[f&15]+i[o>>>28&15]+i[o>>>24&15]+i[o>>>20&15]+i[o>>>16&15]+i[o>>>12&15]+i[o>>>8&15]+i[o>>>4&15]+i[o&15]+i[b>>>28&15]+i[b>>>24&15]+i[b>>>20&15]+i[b>>>16&15]+i[b>>>12&15]+i[b>>>8&15]+i[b>>>4&15]+i[b&15]+i[p>>>28&15]+i[p>>>24&15]+i[p>>>20&15]+i[p>>>16&15]+i[p>>>12&15]+i[p>>>8&15]+i[p>>>4&15]+i[p&15]+i[U>>>28&15]+i[U>>>24&15]+i[U>>>20&15]+i[U>>>16&15]+i[U>>>12&15]+i[U>>>8&15]+i[U>>>4&15]+i[U&15];return this.is224||(k+=i[d>>>28&15]+i[d>>>24&15]+i[d>>>20&15]+i[d>>>16&15]+i[d>>>12&15]+i[d>>>8&15]+i[d>>>4&15]+i[d&15]),k},C.prototype.toString=C.prototype.hex,C.prototype.digest=function(){this.finalize();var l=this.h0,y=this.h1,f=this.h2,o=this.h3,b=this.h4,p=this.h5,U=this.h6,d=this.h7,k=[l>>>24&255,l>>>16&255,l>>>8&255,l&255,y>>>24&255,y>>>16&255,y>>>8&255,y&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,o>>>24&255,o>>>16&255,o>>>8&255,o&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255,U>>>24&255,U>>>16&255,U>>>8&255,U&255];return this.is224||k.push(d>>>24&255,d>>>16&255,d>>>8&255,d&255),k},C.prototype.array=C.prototype.digest,C.prototype.arrayBuffer=function(){this.finalize();var l=new ArrayBuffer(this.is224?28:32),y=new DataView(l);return y.setUint32(0,this.h0),y.setUint32(4,this.h1),y.setUint32(8,this.h2),y.setUint32(12,this.h3),y.setUint32(16,this.h4),y.setUint32(20,this.h5),y.setUint32(24,this.h6),this.is224||y.setUint32(28,this.h7),l};function ge(l,y,f){var o,b=typeof l;if(b==="string"){var p=[],U=l.length,d=0,k;for(o=0;o<U;++o)k=l.charCodeAt(o),k<128?p[d++]=k:k<2048?(p[d++]=192|k>>>6,p[d++]=128|k&63):k<55296||k>=57344?(p[d++]=224|k>>>12,p[d++]=128|k>>>6&63,p[d++]=128|k&63):(k=65536+((k&1023)<<10|l.charCodeAt(++o)&1023),p[d++]=240|k>>>18,p[d++]=128|k>>>12&63,p[d++]=128|k>>>6&63,p[d++]=128|k&63);l=p}else if(b==="object"){if(l===null)throw new Error(t);if(g&&l.constructor===ArrayBuffer)l=new Uint8Array(l);else if(!Array.isArray(l)&&(!g||!ArrayBuffer.isView(l)))throw new Error(t)}else throw new Error(t);l.length>64&&(l=new C(y,!0).update(l).array());var v=[],F=[];for(o=0;o<64;++o){var S=l[o]||0;v[o]=92^S,F[o]=54^S}C.call(this,y,f),this.update(F),this.oKeyPad=v,this.inner=!0,this.sharedMemory=f}ge.prototype=new C,ge.prototype.finalize=function(){if(C.prototype.finalize.call(this),this.inner){this.inner=!1;var l=this.array();C.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(l),C.prototype.finalize.call(this)}};var Q=O();Q.sha256=Q,Q.sha224=O(!0),Q.sha256.hmac=he(),Q.sha224.hmac=he(!0),h?r.exports=Q:(s.sha256=Q.sha256,s.sha224=Q.sha224)})()})(We)),We.exports}var Kr=Tn();class $n extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","url","hash"]);this.baseURL="https://www.maltiverse.com",this.name="Maltiverse"}searchByIP(e){return u(`${this.baseURL}/ip/${e}`)}searchByDomain(e){return u(`${this.baseURL}/hostname/${e}`)}searchByURL(e){const s=Kr.sha256(e);return u(`${this.baseURL}/url/${s}`)}searchByHash(e){return u(`${this.baseURL}/search;query=${e}`)}}const En=32,Fn=40,Pn=64;class In extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash"]);this.baseURL="https://bazaar.abuse.ch",this.name="MalwareBazaar"}searchByHash(e){return e.length===En?this.searchByMD5(e):e.length===Fn?this.searchBySHA1(e):e.length===Pn?this.searchBySHA256(e):u(m(this.baseURL,"/browse.php",{search:e}))}searchByMD5(e){const s=`md5:${e}`;return u(m(this.baseURL,"/browse.php",{search:s}))}searchBySHA1(e){const s=`sha1:${e}`;return u(m(this.baseURL,"/browse.php",{search:s}))}searchBySHA256(e){const s=`sha256:${e}`;return u(m(this.baseURL,"/browse.php",{search:s}))}}class _n extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["cve"]);this.baseURL="https://nvd.nist.gov",this.name="NVD"}searchByCVE(e){return u(m(this.baseURL,`/vuln/detail/${e}`))}}class Cn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["email"]);this.baseURL="https://data.occrp.org",this.name="OCCPR"}searchByEmail(e){return u(m(this.baseURL,"/search",{facet:"email","filter:emails":e}))}}class jn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip"]);this.baseURL="https://www.onyphe.io",this.name="ONYPHE"}searchByIP(e){return u(m(this.baseURL,`/summary/ip/${e}`))}}class On extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash"]);this.baseURL="https://opentip.kaspersky.com",this.name="OpenTIP"}searchByHash(e){return u(m(this.baseURL,`/${e}`))}}class Dn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","url","hash","cve"]);this.baseURL="https://otx.alienvault.com",this.name="OTX"}searchByIP(e){return u(m(this.baseURL,`/indicator/ip/${e}`))}searchByURL(e){return u(m(this.baseURL,`/indicator/url/${e}`))}searchByDomain(e){return u(m(this.baseURL,`/indicator/domain/${e}`))}searchByHash(e){return u(m(this.baseURL,`/indicator/file/${e}`))}searchByCVE(e){return u(m(this.baseURL,`/indicator/cve/${e}`))}}class Mn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","url","hash"]);this.baseURL="https://pulsedive.com",this.name="Pulsedive"}searchByIP(e){return this.search(e)}searchByDomain(e){return this.search(e)}searchByURL(e){return this.search(e)}searchByHash(e){return this.search(e)}search(e){return u(`${this.baseURL}/indicator/?ioc=${wt(e)}`)}}class Nn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain"]);this.baseURL="https://radar.cloudflare.com",this.name="Radar"}searchByIP(e){return u(m(this.baseURL,`/ip/${e}`))}searchByDomain(e){return u(m(this.baseURL,`/domain/${e}`))}}class qn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["domain","ip"]);this.baseURL="https://www.robtex.com",this.name="Robtex"}searchByDomain(e){return u(m(this.baseURL,`/dns-lookup/${e}`))}searchByIP(e){return u(m(this.baseURL,`/ip-lookup/${e}`))}}class zn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["domain","ip","hash"]);this.baseURL="https://www.scumware.org",this.name="Scumware"}searchByDomain(e){return u(m(this.baseURL,`/report/${e}`))}searchByIP(e){return u(m(this.baseURL,`/report/${e}`))}searchByHash(e){return e.length!==32?T("Scumware supports only MD5 hashes"):u(m(this.baseURL,`/report/${e}`))}}class Hn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain"]);this.baseURL="https://securitytrails.com",this.name="SecurityTrails"}searchByIP(e){return u(m(this.baseURL,`/list/ip/${e}`))}searchByDomain(e){return u(m(this.baseURL,`/domain/${e}`))}}class Vn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","asn"]);this.baseURL="https://www.shodan.io",this.name="Shodan"}searchByASN(e){return u(m(this.baseURL,"/search",{query:`asn:${e}`}))}searchByIP(e){return u(m(this.baseURL,`/host/${e}`))}searchByDomain(e){return u(m(this.baseURL,"/search",{query:`hostname:${e}`}))}}class Kn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["cve"]);this.baseURL="https://sploitus.com",this.name="Sploitus"}searchByCVE(e){return u(m(this.baseURL,"/",{query:e}))}}class Wn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain"]);this.baseURL="https://talosintelligence.com",this.name="Talos"}searchByIP(e){return this.search(e)}searchByDomain(e){return this.search(e)}search(e){return u(m(this.baseURL,"/reputation_center/lookup",{search:e}))}}class Gn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain"]);this.baseURL="https://threatbook.io",this.name="ThreatBook"}searchByIP(e){return u(m(this.baseURL,`/ip/${e}`))}searchByDomain(e){return u(m(this.baseURL,`/domain/${e}`))}}class Jn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","email"]);this.baseURL="https://app.threatconnect.com",this.name="ThreatConnect"}searchByIP(e){return this.searchByType("address",e)}searchByDomain(e){return this.searchByType("host",e)}searchByEmail(e){return this.searchByType("emailaddress",e)}searchByType(e,s){const a={};return a[e]=s,u(m(this.baseURL,`/auth/indicators/details/${e}.xhtml`,a))}}class Zn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","hash"]);this.baseURL="https://www.threatminer.org",this.name="ThreatMiner"}searchByIP(e){return u(m(this.baseURL,"/host.php",{q:e}))}searchByDomain(e){return u(m(this.baseURL,"/domain.php",{q:e}))}searchByHash(e){return u(m(this.baseURL,"/sample.php",{q:e}))}}class Yn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain"]);this.baseURL="https://threatintelligenceplatform.com",this.name="TIP"}searchByIP(e){return u(m(this.baseURL,`/report/${e}/`))}searchByDomain(e){return u(m(this.baseURL,`/report/${e}/`))}}class Xn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash","url"]);this.baseURL="https://tria.ge",this.name="Triage"}searchByHash(e){return u(m(this.baseURL,"/s",{q:e}))}searchByURL(e){return u(m(this.baseURL,"/s",{q:`url:${e}`}))}}class Qn extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain"]);this.baseURL="https://urlhaus.abuse.ch",this.name="URLhaus"}searchByIP(e){return this.searchByHost(e)}searchByDomain(e){return this.searchByHost(e)}searchByHost(e){return u(m(this.baseURL,`/host/${e}/`))}}class ea extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","asn","url"]);this.baseURL="https://urlscan.io",this.name="urlscan.io"}searchByIP(e){return u(m(this.baseURL,`/ip/${e}`))}searchByDomain(e){return u(m(this.baseURL,`/domain/${e}`))}searchByASN(e){const s=ye(e);return u(m(this.baseURL,`/asn/AS${s}`))}searchByURL(e){return u(m(this.baseURL,`/search/#${encodeURIComponent(`page.url:"${e}" OR task.url:"${e}"`)}`))}}class ra extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["domain"]);this.baseURL="https://www.urlvoid.com",this.name="URLVoid"}searchByDomain(e){return u(m(this.baseURL,`/scan/${e}`))}}class ta extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","email"]);this.baseURL="https://viewdns.info",this.name="ViewDNS"}searchByIP(e){return u(m(this.baseURL,"/reverseip/",{t:1,host:e}))}searchByDomain(e){return u(m(this.baseURL,"/iphistory/",{domain:e}))}searchByEmail(e){return u(m(this.baseURL,"/reversewhois/",{q:e}))}}class sa extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","url","hash"]);this.baseURL="https://www.virustotal.com",this.name="VirusTotal"}searchByIP(e){return u(m(this.baseURL,`/gui/ip-address/${e}/details`))}searchByURL(e){const s=Kr.sha256(this.normalizeURL(e));return u(m(this.baseURL,`/gui/url/${s}/details`))}searchByDomain(e){return u(m(this.baseURL,`/gui/domain/${e}/details`))}searchByHash(e){return u(m(this.baseURL,`/gui/file/${e}/details`))}normalizeURL(e){return new URL(e).pathname==="/"&&!e.endsWith("/")?`${e}/`:e}}class na extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["hash"]);this.baseURL="https://www.vmray.com",this.name="VMRay"}searchByHash(e){if(e.length!==64)return T("VMRay supports SHA256 hash only");const s=e.substring(0,12);return u(m(this.baseURL,`/analyses/${s}/report/overview.html`))}}class aa extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["cve"]);this.baseURL="https://vulmon.com",this.name="Vulmon"}searchByCVE(e){return u(m(this.baseURL,"/vulnerabilitydetails",{qid:e}))}}class ia extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["domain"]);this.baseURL="https://web-check.xyz",this.name="WebCheck"}searchByDomain(e){return u(m(this.baseURL,`/results/${e}`))}}class oa extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip","domain","hash"]);this.baseURL="https://exchange.xforce.ibmcloud.com",this.name="X-Force-Exchange"}searchByIP(e){return u(m(this.baseURL,`/ip/${e}`))}searchByDomain(e){return u(m(this.baseURL,`/url/${e}`))}searchByHash(e){return u(m(this.baseURL,`/malware/${e}`))}}class ca extends A{constructor(){super();n(this,"baseURL");n(this,"name");n(this,"supportedTypes",["ip"]);this.baseURL="https://www.zoomeye.ai",this.name="ZoomEye"}searchByIP(e){const s=Rr.encode(`ip="${e}"`);return u(m(this.baseURL,"/searchResult",{q:s}))}}const ua=[new Js,new Ys,new Xs,new Qs,new en,new rn,new tn,new sn,new nn,new an,new on,new cn,new un,new ln,new hn,new pn,new mn,new fn,new dn,new gn,new bn,new yn,new xn,new wn,new An,new vn,new Rn,new Un,new kn,new $n,new In,new _n,new Cn,new jn,new On,new Dn,new Mn,new Nn,new qn,new zn,new Hn,new Vn,new Kn,new Wn,new Gn,new Jn,new Zn,new Yn,new Xn,new Qn,new ea,new ra,new ta,new sa,new na,new aa,new oa,new ca,new ia],la=W(zr,{});class Be{constructor(t,e=la){n(this,"input");n(this,"options");n(this,"scanners");n(this,"searchers");n(this,"scanFuncWrappers",[{type:"url",func:this.getURL=this.getURL.bind(this)},{type:"domain",func:this.getDomain=this.getDomain.bind(this)},{type:"ip",func:this.getIP=this.getIP.bind(this)}]);let s=e.refang?Xt(t):t;s=e.punycode?Qt(s):s,this.input=s,this.options=e,this.searchers=ua.filter(a=>!this.options.disabledSearcherNames.includes(a.name)),this.scanners=Vs.filter(a=>!this.options.disabledScannerNames.includes(a.name))}getIP(){return Bs(this.input)}getDomain(){return ks(this.input,this.options)}getURL(){return Ss(this.input,this.options)}getEmail(){return Ls(this.input,this.options)}getASN(){return Us(this.input)}getHash(){const t=Rs(this.input);if(t)return t;const e=vs(this.input);if(e)return e;const s=As(this.input);return s||null}getCVE(){return Ts(this.input)}getBTC(){return $s(this.input)}getXMR(){return Es(this.input)}getGATrackID(){return Ps(this.input)}getGAPubID(){return Fs(this.input)}getETH(){return Is(this.input)}getSearchersByType(t){return this.searchers.filter(e=>e.supportedTypes.includes(t))}getScannersByType(t){return this.scanners.filter(e=>e.supportedTypes.includes(t))}getSearchFuncWrappers(){return this.input.includes(".")?[{type:"url",func:this.getURL=this.getURL.bind(this)},{type:"email",func:this.getEmail=this.getEmail.bind(this)},{type:"domain",func:this.getDomain=this.getDomain.bind(this)},{type:"ip",func:this.getIP=this.getIP.bind(this)}]:[{type:"asn",func:this.getASN=this.getASN.bind(this)},{type:"hash",func:this.getHash=this.getHash.bind(this)},{type:"cve",func:this.getCVE=this.getCVE.bind(this)},{type:"btc",func:this.getBTC=this.getBTC.bind(this)},{type:"gaTrackID",func:this.getGATrackID=this.getGATrackID.bind(this)},{type:"gaPubID",func:this.getGAPubID=this.getGAPubID.bind(this)},{type:"eth",func:this.getETH=this.getETH.bind(this)}]}getSearcherSlots(){const t=this.getSearchFuncWrappers();for(const e of t){const s=e.func.apply(this);if(s){const a=e.type,c=this.getSearchersByType(a),h=c.map(g=>({analyzer:g,type:a,query:s}));return c.length>1&&h.push({analyzer:new Zs,type:a,query:s}),h}}return[]}getScannerSlots(){for(const t of this.scanFuncWrappers){const e=t.type,s=t.func.apply(this);if(s)return this.getScannersByType(e).map(c=>({analyzer:c,type:e,query:s}))}return[]}getSlots(){const t=this.getSearcherSlots(),e=this.getScannerSlots();return t.concat(e)}}class ha{constructor(t,e){n(this,"command");n(this,"options");n(this,"searcherMap",{ip:(t,e)=>t.searchByIP(e),domain:(t,e)=>t.searchByDomain(e),url:(t,e)=>t.searchByURL(e),asn:(t,e)=>t.searchByASN(e),email:(t,e)=>t.searchByEmail(e),hash:(t,e)=>t.searchByHash(e),cve:(t,e)=>t.searchByCVE(e),btc:(t,e)=>t.searchByBTC(e),gaPubID:(t,e)=>t.searchByGAPubID(e),gaTrackID:(t,e)=>t.searchByGATrackID(e),eth:(t,e)=>t.searchByETH(e)});n(this,"scannerMap",{ip:(t,e)=>t.scanByIP(e),domain:(t,e)=>t.scanByDomain(e),url:(t,e)=>t.scanByURL(e)});this.command=t,this.options=e}search(){const t=()=>{const c=new Be(this.command.query,this.options).getSearcherSlots().find(h=>h.analyzer.name===this.command.name);return c?Ur(c.analyzer)?u(c):T(`${c.analyzer.name} is not a searcher`):T(`Slot for ${this.command.name} is missing`)},e=s=>{const a=s.analyzer;if(this.command.type in this.searcherMap){const c=this.searcherMap[this.command.type];return c(a,s.query)}return T("Something goes wrong")};return t().andThen(e)}searchAll(){return new Be(this.command.query,this.options).getSearcherSlots().filter(a=>a.analyzer.name!=="all").map(a=>{const c=a.analyzer;if(this.command.type in this.searcherMap){const h=this.searcherMap[this.command.type];return h(c,a.query)}return T(`${this.command.type} is not supported`)})}scan(){const t=()=>{const c=new Be(this.command.query).getScannerSlots().find(h=>h.analyzer.name===this.command.name);return c?vt(c.analyzer)?Sr(c):G(`${c.analyzer.name} is not a scanner`):G(`Slot for ${this.command.name} is missing`)},e=s=>{const a=s.analyzer;switch(a.name){case"HybridAnalysis":a.setAPIKey(this.options.hybridAnalysisAPIKey);break;case"urlscan.io":a.setAPIKey(this.options.urlscanAPIKey),a.setVisibility(this.options.urlscanVisibility);break;case"VirusTotal":a.setAPIKey(this.options.virusTotalAPIKey);break}if(s.type in this.scannerMap){const c=this.scannerMap[s.type];return c(a,s.query)}return G("Something goes wrong")};return t().andThen(e)}}const pa=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(r=>[r.name,r]),ma=new Map(pa);class Ge extends Error{constructor(e){super(Ge._prepareSuperMessage(e));n(this,"name","NonError")}static _prepareSuperMessage(e){try{return JSON.stringify(e)}catch{return String(e)}}}const fa=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],Je=new WeakSet,da=r=>{Je.add(r);const t=r.toJSON();return Je.delete(r),t},Wr=r=>ma.get(r)??Error,Ze=({from:r,seen:t,to:e,forceEnumerable:s,maxDepth:a,depth:c,useToJSON:h,serialize:g})=>{if(!e)if(Array.isArray(r))e=[];else if(!g&&Gr(r)){const w=Wr(r.name);e=new w}else e={};if(t.push(r),c>=a)return e;if(h&&typeof r.toJSON=="function"&&!Je.has(r))return da(r);const i=w=>Ze({from:w,seen:[...t],forceEnumerable:s,maxDepth:a,depth:c,useToJSON:h,serialize:g});for(const[w,x]of Object.entries(r)){if(x&&x instanceof Uint8Array&&x.constructor.name==="Buffer"){e[w]="[object Buffer]";continue}if(x!==null&&typeof x=="object"&&typeof x.pipe=="function"){e[w]="[object Stream]";continue}if(typeof x!="function"){if(!x||typeof x!="object"){try{e[w]=x}catch{}continue}if(!t.includes(r[w])){c++,e[w]=i(r[w]);continue}e[w]="[Circular]"}}for(const{property:w,enumerable:x}of fa)typeof r[w]<"u"&&r[w]!==null&&Object.defineProperty(e,w,{value:Gr(r[w])?i(r[w]):r[w],enumerable:s?!0:x,configurable:!0,writable:!0});return e};function ga(r,t={}){const{maxDepth:e=Number.POSITIVE_INFINITY,useToJSON:s=!0}=t;return typeof r=="object"&&r!==null?Ze({from:r,seen:[],forceEnumerable:!0,maxDepth:e,depth:0,useToJSON:s,serialize:!0}):typeof r=="function"?`[Function: ${r.name||"anonymous"}]`:r}function ba(r,t={}){const{maxDepth:e=Number.POSITIVE_INFINITY}=t;if(r instanceof Error)return r;if(ya(r)){const s=Wr(r.name);return Ze({from:r,seen:[],to:new s,maxDepth:e,depth:0,serialize:!1})}return new Ge(r)}function Gr(r){return!!r&&typeof r=="object"&&"name"in r&&"message"in r&&"stack"in r}function ya(r){return!!r&&typeof r=="object"&&"message"in r&&!Array.isArray(r)}var xa=Object.defineProperty,wa=Object.defineProperties,Aa=Object.getOwnPropertyDescriptors,Jr=Object.getOwnPropertySymbols,va=Object.prototype.hasOwnProperty,Ra=Object.prototype.propertyIsEnumerable,Zr=(r,t,e)=>t in r?xa(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Yr=(r,t)=>{for(var e in t||(t={}))va.call(t,e)&&Zr(r,e,t[e]);if(Jr)for(var e of Jr(t))Ra.call(t,e)&&Zr(r,e,t[e]);return r},Xr=(r,t)=>wa(r,Aa(t)),Ua=(r,t,e)=>new Promise((s,a)=>{var c=i=>{try{g(e.next(i))}catch(w){a(w)}},h=i=>{try{g(e.throw(i))}catch(w){a(w)}},g=i=>i.done?s(i.value):Promise.resolve(i.value).then(c,h);g((e=e.apply(r,t)).next())});function ka(r){let t,e={};function s(){Object.entries(e).length===0&&(t==null||t(),t=void 0)}let a=Math.floor(Math.random()*1e4);function c(){return a++}return{sendMessage(h,g,...i){return Ua(this,null,function*(){var w,x,L,$;const R={id:c(),type:h,data:g,timestamp:Date.now()},E=(x=yield(w=r.verifyMessageData)==null?void 0:w.call(r,R))!=null?x:R;(L=r.logger)==null||L.debug(`[messaging] sendMessage {id=${E.id}} ─ᐅ`,E,...i);const O=yield r.sendMessage(E,...i),{res:I,err:_}=O??{err:new Error("No response")};if(($=r.logger)==null||$.debug(`[messaging] sendMessage {id=${E.id}} ᐊ─`,{res:I,err:_}),_!=null)throw ba(_);return I})},onMessage(h,g){var i,w,x;if(t==null&&((i=r.logger)==null||i.debug(`[messaging] "${h}" initialized the message listener for this context`),t=r.addRootListener(L=>{var $,R;if(typeof L.type!="string"||typeof L.timestamp!="number"){if(r.breakError)return;const I=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(L)}`);throw($=r.logger)==null||$.error(I),I}(R=r==null?void 0:r.logger)==null||R.debug("[messaging] Received message",L);const E=e[L.type];if(E==null)return;const O=E(L);return Promise.resolve(O).then(I=>{var _,he;return(he=(_=r.verifyMessageData)==null?void 0:_.call(r,I))!=null?he:I}).then(I=>{var _;return(_=r==null?void 0:r.logger)==null||_.debug(`[messaging] onMessage {id=${L.id}} ─ᐅ`,{res:I}),{res:I}}).catch(I=>{var _;return(_=r==null?void 0:r.logger)==null||_.debug(`[messaging] onMessage {id=${L.id}} ─ᐅ`,{err:I}),{err:ga(I)}})})),e[h]!=null){const L=Error(`[messaging] In this JS context, only one listener can be setup for ${h}`);throw(w=r.logger)==null||w.error(L),L}return e[h]=g,(x=r.logger)==null||x.log(`[messaging] Added listener for ${h}`),()=>{delete e[h],s()}},removeAllListeners(){Object.keys(e).forEach(h=>{delete e[h]}),s()}}}var Se={exports:{}},La=Se.exports,Qr;function Ba(){return Qr||(Qr=1,(function(r,t){(function(e,s){s(r)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:La,function(e){var s,a;if(!((a=(s=globalThis.chrome)==null?void 0:s.runtime)!=null&&a.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const c="The message port closed before a response was received.",h=g=>{const i={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(i).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class w extends WeakMap{constructor(o,b=void 0){super(b),this.createItem=o}get(o){return this.has(o)||this.set(o,this.createItem(o)),super.get(o)}}const x=f=>f&&typeof f=="object"&&typeof f.then=="function",L=(f,o)=>(...b)=>{g.runtime.lastError?f.reject(new Error(g.runtime.lastError.message)):o.singleCallbackArg||b.length<=1&&o.singleCallbackArg!==!1?f.resolve(b[0]):f.resolve(b)},$=f=>f==1?"argument":"arguments",R=(f,o)=>function(p,...U){if(U.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${$(o.minArgs)} for ${f}(), got ${U.length}`);if(U.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${$(o.maxArgs)} for ${f}(), got ${U.length}`);return new Promise((d,k)=>{if(o.fallbackToNoCallback)try{p[f](...U,L({resolve:d,reject:k},o))}catch(v){console.warn(`${f} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,v),p[f](...U),o.fallbackToNoCallback=!1,o.noCallback=!0,d()}else o.noCallback?(p[f](...U),d()):p[f](...U,L({resolve:d,reject:k},o))})},E=(f,o,b)=>new Proxy(o,{apply(p,U,d){return b.call(U,f,...d)}});let O=Function.call.bind(Object.prototype.hasOwnProperty);const I=(f,o={},b={})=>{let p=Object.create(null),U={has(k,v){return v in f||v in p},get(k,v,F){if(v in p)return p[v];if(!(v in f))return;let S=f[v];if(typeof S=="function")if(typeof o[v]=="function")S=E(f,f[v],o[v]);else if(O(b,v)){let V=R(v,b[v]);S=E(f,f[v],V)}else S=S.bind(f);else if(typeof S=="object"&&S!==null&&(O(o,v)||O(b,v)))S=I(S,o[v],b[v]);else if(O(b,"*"))S=I(S,o[v],b["*"]);else return Object.defineProperty(p,v,{configurable:!0,enumerable:!0,get(){return f[v]},set(V){f[v]=V}}),S;return p[v]=S,S},set(k,v,F,S){return v in p?p[v]=F:f[v]=F,!0},defineProperty(k,v,F){return Reflect.defineProperty(p,v,F)},deleteProperty(k,v){return Reflect.deleteProperty(p,v)}},d=Object.create(f);return new Proxy(d,U)},_=f=>({addListener(o,b,...p){o.addListener(f.get(b),...p)},hasListener(o,b){return o.hasListener(f.get(b))},removeListener(o,b){o.removeListener(f.get(b))}}),he=new w(f=>typeof f!="function"?f:function(b){const p=I(b,{},{getContent:{minArgs:0,maxArgs:0}});f(p)}),C=new w(f=>typeof f!="function"?f:function(b,p,U){let d=!1,k,v=new Promise(B=>{k=function(D){d=!0,B(D)}}),F;try{F=f(b,p,k)}catch(B){F=Promise.reject(B)}const S=F!==!0&&x(F);if(F!==!0&&!S&&!d)return!1;const V=B=>{B.then(D=>{U(D)},D=>{let Z;D&&(D instanceof Error||typeof D.message=="string")?Z=D.message:Z="An unexpected error occurred",U({__mozWebExtensionPolyfillReject__:!0,message:Z})}).catch(D=>{console.error("Failed to send onMessage rejected reply",D)})};return V(S?F:v),!0}),ge=({reject:f,resolve:o},b)=>{g.runtime.lastError?g.runtime.lastError.message===c?o():f(new Error(g.runtime.lastError.message)):b&&b.__mozWebExtensionPolyfillReject__?f(new Error(b.message)):o(b)},Q=(f,o,b,...p)=>{if(p.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${$(o.minArgs)} for ${f}(), got ${p.length}`);if(p.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${$(o.maxArgs)} for ${f}(), got ${p.length}`);return new Promise((U,d)=>{const k=ge.bind(null,{resolve:U,reject:d});p.push(k),b.sendMessage(...p)})},l={devtools:{network:{onRequestFinished:_(he)}},runtime:{onMessage:_(C),onMessageExternal:_(C),sendMessage:Q.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:Q.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},y={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return i.privacy={network:{"*":y},services:{"*":y},websites:{"*":y}},I(g,l,i)};e.exports=h(chrome)}else e.exports=globalThis.browser})})(Se)),Se.exports}var Sa=Ba();const Te=Bn(Sa);function Ta(r){return ka(Xr(Yr({},r),{sendMessage(t,e){if(e==null)return Te.runtime.sendMessage(t);const s=typeof e=="number"?{tabId:e}:e;return Te.tabs.sendMessage(s.tabId,t,s.frameId!=null?{frameId:s.frameId}:void 0)},addRootListener(t){const e=(s,a)=>t(typeof s=="object"?Xr(Yr({},s),{sender:a}):s);return Te.runtime.onMessage.addListener(e),()=>Te.runtime.onMessage.removeListener(e)}}))}const{onMessage:$a}=Ta(),et="options",rt="localOptions";async function Ea(){const r=(async()=>{try{const a=await chrome.storage.sync.get(et);return W(Ve,a[et]||{})}catch{return W(Ve,{})}})(),t=(async()=>{try{const a=await chrome.storage.local.get(rt);return W(Ke,a[rt]||{})}catch{return W(Ke,{})}})(),[e,s]=await Promise.all([r,t]);return W(zr,{...e,...s})}function Ye(r){chrome.notifications.create({iconUrl:"https://raw.githubusercontent.com/ninoseki/mitaka/master/assets/icon.png",message:r,title:"Mitaka",type:"basic"})}async function Fa(r){(await r.scan()).match(async s=>{await chrome.tabs.create({url:s})},s=>Ye(s))}async function Pa(r){const t=r.searchAll();for(const e of t)e.match(async s=>{await chrome.tabs.create({url:s})},s=>Ye(s))}async function Ia(r){r.search().match(async e=>{await chrome.tabs.create({url:e})},e=>Ye(e))}function _a(r,t){const e=new Be(r,t),s=["selection"],a=e.getSlots();for(const c of a){const h=c.analyzer.name,i={action:Ur(c.analyzer)?"search":"scan",name:h,query:c.query,type:c.type},w=Lt(i),x=Tt(i);chrome.contextMenus.create({contexts:s,id:w,title:x},()=>{t.debug&&console.debug(`Mitaka: context menu:${w} created`)})}}const Ca=ce(()=>{$a("createContextMenus",r=>{chrome.contextMenus.removeAll(()=>{_a(r.data.text,r.data.options)})}),chrome.contextMenus.onClicked.addListener(async r=>{const t=r.menuItemId.toString(),e=W(Gs,JSON.parse(t)),s=await Ea(),a=new ha(e,s);switch(a.command.action){case"search":if(a.command.name==="all"){await Pa(a);break}await Ia(a);break;case"scan":await Fa(a);break}chrome.contextMenus.removeAll()})});function Ya(){}(st=(tt=globalThis.browser)==null?void 0:tt.runtime)!=null&&st.id?globalThis.browser:globalThis.chrome;function $e(r,...t){}const ja={debug:(...r)=>$e(console.debug,...r),log:(...r)=>$e(console.log,...r),warn:(...r)=>$e(console.warn,...r),error:(...r)=>$e(console.error,...r)};let Xe;try{Xe=Ca.main(),Xe instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(r){throw ja.error("The background crashed on startup!"),r}return Xe})();
